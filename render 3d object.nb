(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10416,        298]
NotebookOptionsPosition[      9033,        268]
NotebookOutlinePosition[      9428,        284]
CellTagsIndexPosition[      9385,        281]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Rz", "[", "a_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "a", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "a", "]"}], ",", 
      RowBox[{"Cos", "[", "a", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"Ry", "[", "a_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "a", "]"}], ",", "0", ",", 
      RowBox[{"Sin", "[", "a", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}], ",", "0", ",", 
      RowBox[{"Cos", "[", "a", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rx", "[", "a_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Cos", "[", "a", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sin", "[", "a", "]"}], ",", 
      RowBox[{"Cos", "[", "a", "]"}]}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8268967892809563`*^9, 3.826896877805148*^9}, {
   3.826896936667078*^9, 3.826896946650323*^9}, 3.8314643956918497`*^9, {
   3.833101306492206*^9, 3.8331013137440033`*^9}, {3.8331014884184113`*^9, 
   3.83310148907117*^9}, {3.8591250527691507`*^9, 3.859125097558199*^9}, {
   3.8591253079357967`*^9, 3.859125319190868*^9}, {3.859431507532988*^9, 
   3.859431512178989*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"60ae39d5-f08a-4530-902f-b6bff550122b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Rz", "[", "c", "]"}], ".", 
   RowBox[{"Rx", "[", 
    RowBox[{"-", "b"}], "]"}], ".", 
   RowBox[{"Rz", "[", "a", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8591253452324343`*^9, 3.85912536213386*^9}, 
   3.8591257846438932`*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"e4b20a12-0b2f-42fe-b300-3174ad592b12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], 
      RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], 
      RowBox[{"(", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], ")"}]}], ",", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.859125792301222*^9, 3.859125800259227*^9}, {
  3.859431541364416*^9, 3.859431573084942*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"740ac50e-a62d-4698-854f-37246afe1d1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", "r"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.859125802075823*^9, 3.859125823084219*^9}, {
  3.859127193714328*^9, 3.8591271945535793`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"9243d912-5fdc-430b-bfb5-e22ab335b895"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "b", "]"}]}], " ", 
     RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "a", "]"}], " ", 
     RowBox[{"Sin", "[", "c", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "c", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "a", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "a", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "c", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", "b", "]"}], " ", 
     RowBox[{"Sin", "[", "c", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "c", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "c", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", 
     RowBox[{"Sin", "[", "b", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "b", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.859125806847896*^9, 3.85912582397902*^9}, 
   3.859127195400669*^9, 3.859127524830441*^9, 3.859127556420793*^9, {
   3.859127914910246*^9, 3.859127929745571*^9}, 3.859431536091004*^9, 
   3.8594315921476707`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"4659fd96-d082-410f-9ea7-cdb3ad3a0351"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "this", " ", "is", " ", "the", " ", "x", " ", "coordinate", " ", "in", " ", 
   "the", " ", "3", "D", " ", "projection"}], "*)"}]], "Input",
 CellChangeTimes->{{3.85943167129843*^9, 
  3.859431678167716*^9}},ExpressionUUID->"38184145-a4de-4bc8-90f5-\
7638c0e02e8c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"rp", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], 
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", "d"}]]}], ")"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8594315980376377`*^9, 3.8594316075738163`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"1ce1dd9f-ce4a-49a0-baf9-0e45ca4cdbad"],

Cell["\<\
(d*(Cos(c)*Cos(a - \[Lambda])*Cos(\[Phi]) - Sin(c)*(Cos(b)*Cos(\[Phi])*Sin(a \
- \[Lambda]) + Sin(b)*Sin(\[Phi]))))/
   (d + l + Cos(a - \[Lambda])*Cos(\[Phi])*Sin(c) + \
Cos(b)*Cos(c)*Cos(\[Phi])*Sin(a - \[Lambda]) + Cos(c)*Sin(b)*Sin(\[Phi]))\
\>", "Output",
 CellChangeTimes->{{3.8591275458450193`*^9, 3.859127556887639*^9}, 
   3.8591279298122473`*^9, 3.859431610598949*^9},
 CellLabel->
  "Out[46]//CForm=",ExpressionUUID->"88e3c74e-9409-42cc-b98c-14927e8a2a59"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "this", " ", "is", " ", "the", " ", "z", " ", "coordinate", " ", "in", " ", 
   "the", " ", "3", "d", " ", "projection"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8594316800256166`*^9, 
  3.859431685311953*^9}},ExpressionUUID->"f2c7bf94-e25a-45d9-ae90-\
edfc4966ae6a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"rp", "[", 
     RowBox[{"[", "3", "]"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], 
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", "d"}]]}], ")"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8594316170976257`*^9, 3.859431623030797*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"e39e7286-994f-4f1a-ac50-905416e67e55"],

Cell["\<\
(-(d*Cos(\[Phi])*Sin(b)*Sin(a - \[Lambda])) + d*Cos(b)*Sin(\[Phi]))/(d + l + \
Cos(a - \[Lambda])*Cos(\[Phi])*Sin(c) + Cos(b)*Cos(c)*Cos(\[Phi])*Sin(a - \
\[Lambda]) + Cos(c)*Sin(b)*Sin(\[Phi]))\
\>", "Output",
 CellChangeTimes->{3.8594316252298813`*^9},
 CellLabel->
  "Out[47]//CForm=",ExpressionUUID->"78d173b4-46c5-482f-abb0-a2772575d232"]
}, Open  ]]
},
WindowSize->{1440, 806},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d2405eff-1772-4f1d-92d4-d368e1398865"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1902, 53, 73, "Input",ExpressionUUID->"60ae39d5-f08a-4530-902f-b6bff550122b"],
Cell[2463, 75, 432, 11, 30, "Input",ExpressionUUID->"e4b20a12-0b2f-42fe-b300-3174ad592b12"],
Cell[2898, 88, 614, 16, 30, "Input",ExpressionUUID->"740ac50e-a62d-4698-854f-37246afe1d1d"],
Cell[CellGroupData[{
Cell[3537, 108, 385, 9, 30, "Input",ExpressionUUID->"9243d912-5fdc-430b-bfb5-e22ab335b895"],
Cell[3925, 119, 2365, 64, 56, "Output",ExpressionUUID->"4659fd96-d082-410f-9ea7-cdb3ad3a0351"]
}, Open  ]],
Cell[6305, 186, 308, 7, 30, "Input",ExpressionUUID->"38184145-a4de-4bc8-90f5-7638c0e02e8c"],
Cell[CellGroupData[{
Cell[6638, 197, 597, 17, 51, "Input",ExpressionUUID->"1ce1dd9f-ce4a-49a0-baf9-0e45ca4cdbad"],
Cell[7238, 216, 477, 9, 63, "Output",ExpressionUUID->"88e3c74e-9409-42cc-b98c-14927e8a2a59"]
}, Open  ]],
Cell[7730, 228, 311, 7, 30, "Input",ExpressionUUID->"f2c7bf94-e25a-45d9-ae90-edfc4966ae6a"],
Cell[CellGroupData[{
Cell[8066, 239, 595, 17, 51, "Input",ExpressionUUID->"e39e7286-994f-4f1a-ac50-905416e67e55"],
Cell[8664, 258, 353, 7, 45, "Output",ExpressionUUID->"78d173b4-46c5-482f-abb0-a2772575d232"]
}, Open  ]]
}
]
*)

