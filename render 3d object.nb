(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    110541,       3112]
NotebookOptionsPosition[    105346,       3021]
NotebookOutlinePosition[    105744,       3037]
CellTagsIndexPosition[    105701,       3034]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Rz", "[", "a_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "a", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "a", "]"}], ",", 
      RowBox[{"Cos", "[", "a", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"Ry", "[", "a_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "a", "]"}], ",", "0", ",", 
      RowBox[{"Sin", "[", "a", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}], ",", "0", ",", 
      RowBox[{"Cos", "[", "a", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rx", "[", "a_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Cos", "[", "a", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sin", "[", "a", "]"}], ",", 
      RowBox[{"Cos", "[", "a", "]"}]}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8268967892809563`*^9, 3.826896877805148*^9}, {
   3.826896936667078*^9, 3.826896946650323*^9}, 3.8314643956918497`*^9, {
   3.833101306492206*^9, 3.8331013137440033`*^9}, {3.8331014884184113`*^9, 
   3.83310148907117*^9}, {3.8591250527691507`*^9, 3.859125097558199*^9}, {
   3.8591253079357967`*^9, 3.859125319190868*^9}, {3.859431507532988*^9, 
   3.859431512178989*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"60ae39d5-f08a-4530-902f-b6bff550122b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"a", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "a", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "a", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "a", "]"}], ",", 
       RowBox[{"Cos", "[", "a", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[5]:=",ExpressionUUID->"8dfd3938-563d-450c-97dd-33ed5a2f6d68"],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"a", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "a", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "a", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "a", "]"}], ",", 
       RowBox[{"Cos", "[", "a", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.85996156837386*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"f1fa26b1-fb94-4a39-a006-a7fb0ffea0a7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumptions", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", ">", "0"}], ",", 
     RowBox[{"l", ">", "0"}], ",", 
     RowBox[{"0", "<", "a", "<", 
      RowBox[{"2", "\[Pi]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "2"}], "<", "b", "<", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
     RowBox[{"0", "<", "c", "<", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "2"}], "<", "\[Phi]", "<", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "<", "\[Lambda]", "<", 
      RowBox[{"2", " ", "\[Pi]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "<", "x", "<", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "<", "y", "<", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "<", "z", "<", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "<", "xp", "<", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "<", "yp", "<", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "<", "zp", "<", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8598593931344213`*^9, 3.85985943873518*^9}, {
  3.8598599511210938`*^9, 3.859859976473051*^9}, {3.859957550734865*^9, 
  3.85995756137467*^9}, {3.859961643122527*^9, 3.85996164722379*^9}, {
  3.8599621399258127`*^9, 3.8599621559993067`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"9049e561-296f-46c3-907a-97807f017e83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Rz", "[", "c", "]"}], ".", 
   RowBox[{"Rx", "[", 
    RowBox[{"-", "b"}], "]"}], ".", 
   RowBox[{"Rz", "[", "a", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8591253452324343`*^9, 3.85912536213386*^9}, 
   3.8591257846438932`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"e4b20a12-0b2f-42fe-b300-3174ad592b12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iR", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Rz", "[", 
    RowBox[{"-", "a"}], "]"}], ".", 
   RowBox[{"Rx", "[", "b", "]"}], ".", 
   RowBox[{"Rz", "[", "c", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8599613695768337`*^9, 3.859961384277033*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"427f537c-be83-493b-92ca-4ebd55cfd7c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], 
      RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], 
      RowBox[{"(", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], ")"}]}], ",", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.859125792301222*^9, 3.859125800259227*^9}, {
  3.859431541364416*^9, 3.859431573084942*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"740ac50e-a62d-4698-854f-37246afe1d1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", "r"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.859125802075823*^9, 3.859125823084219*^9}, {
  3.859127193714328*^9, 3.8591271945535793`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"9243d912-5fdc-430b-bfb5-e22ab335b895"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "b", "]"}]}], " ", 
     RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "a", "]"}], " ", 
     RowBox[{"Sin", "[", "c", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "c", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "a", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "a", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "c", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", "b", "]"}], " ", 
     RowBox[{"Sin", "[", "c", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "c", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "c", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", 
     RowBox[{"Sin", "[", "b", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "b", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.859125806847896*^9, 3.85912582397902*^9}, 
   3.859127195400669*^9, 3.859127524830441*^9, 3.859127556420793*^9, {
   3.859127914910246*^9, 3.859127929745571*^9}, 3.859431536091004*^9, 
   3.8594315921476707`*^9, 3.85951910709398*^9, 3.859618597787492*^9, 
   3.859859175287582*^9, 3.859961392877832*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"e5f15f91-4179-4f0e-a9a3-6982ae7af42f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", "0"}], ";", 
   RowBox[{"b", "=", "0"}], ";", 
   RowBox[{"c", "=", "0"}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.859519115058874*^9, 3.859519123586479*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"1580e638-9c7a-4330-a60d-265146e70ada"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"l", "+", 
       RowBox[{"rp", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], 
      RowBox[{"l", "+", 
       RowBox[{"rp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", "d"}]]}], ")"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", "ass"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.859859617558119*^9, 3.8598596229662323`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"dab47f82-da66-47e6-b516-59954412286c"],

Cell[BoxData[
 FractionBox["d", 
  RowBox[{"d", "+", "l", "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "c", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", "b", "]"}], " ", 
    RowBox[{"Cos", "[", "c", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", "c", "]"}], " ", 
    RowBox[{"Sin", "[", "b", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]]], "Output",
 CellChangeTimes->{{3.8598596144147263`*^9, 3.859859623927043*^9}},
 CellLabel->"Out[15]=",ExpressionUUID->"a5b191c3-7e25-4a5c-8828-56e77d0fc23d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "l", "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "c", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "b", "]"}], " ", 
          RowBox[{"Cos", "[", "c", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "c", "]"}], " ", 
          RowBox[{"Sin", "[", "b", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "x"}], "==", 
      RowBox[{
       RowBox[{"rp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "d"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "l", "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "c", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "b", "]"}], " ", 
          RowBox[{"Cos", "[", "c", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "c", "]"}], " ", 
          RowBox[{"Sin", "[", "b", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "y"}], "==", 
      RowBox[{
       RowBox[{"rp", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "d"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8598595679728327`*^9, 3.8598595697088842`*^9}, {
  3.859859651176539*^9, 3.8598596707702627`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"66ac335d-df3f-4e35-bf61-01a1eab1640a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"eq", ",", 
    RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.859859571429508*^9, 3.859859576020939*^9}, {
  3.859859798187912*^9, 3.859859798851181*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"bfc3cea5-339f-47a4-9e8f-e731e8d7df0c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"Cos", "[", "c", "]"}]}], "+", 
        RowBox[{"x", " ", 
         RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "b", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", "c", "]"}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "b", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", "c", "]"}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "l"}], ")"}], " ", "y"}], "+", 
     RowBox[{"y", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "c", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", " ", 
         RowBox[{"Cos", "[", "b", "]"}], " ", 
         RowBox[{"Cos", "[", "c", "]"}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"Sin", "[", "b", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"Cos", "[", "b", "]"}]}], "+", 
        RowBox[{"y", " ", 
         RowBox[{"Cos", "[", "c", "]"}], " ", 
         RowBox[{"Sin", "[", "b", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8598595946817217`*^9, 3.859859690684292*^9, 
  3.8598598118258047`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"a2b52007-c555-4738-b681-95ecf4ea29cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"eq", ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "\[Lambda]"}], "}"}], ",", " ", 
   RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.85985919496896*^9, 3.8598592063535852`*^9}, {
   3.859859262964594*^9, 3.859859361358864*^9}, {3.8598594878122883`*^9, 
   3.859859490749447*^9}, 3.859859567167225*^9, {3.8598597538338757`*^9, 
   3.859859753896435*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"fe4e88a1-ff55-4211-abc2-dc773b1d80df"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "nsmet", 
   "\"This system cannot be solved with the methods available to Solve.\"", 2,
    23, 1, 20354666835219684584, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.859859988875143*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"c73d39d2-b914-46ed-b43c-30ba841f281d"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{"Cos", "[", "c", "]"}]}], "+", 
          RowBox[{"x", " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", " ", 
           RowBox[{"Cos", "[", "c", "]"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "b", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", " ", 
           RowBox[{"Cos", "[", "c", "]"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", "l"}], ")"}], " ", "y"}], "+", 
       RowBox[{"y", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "-", "\[Lambda]"}], "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y", " ", 
           RowBox[{"Cos", "[", "b", "]"}], " ", 
           RowBox[{"Cos", "[", "c", "]"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"Sin", "[", "b", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "-", "\[Lambda]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{"Cos", "[", "b", "]"}]}], "+", 
          RowBox[{"y", " ", 
           RowBox[{"Cos", "[", "c", "]"}], " ", 
           RowBox[{"Sin", "[", "b", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "\[Lambda]"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", ">", "0"}], ",", 
      RowBox[{"l", ">", "0"}], ",", 
      RowBox[{"0", "<", "a", "<", 
       RowBox[{"2", " ", "\[Pi]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], "<", "b", "<", 
       FractionBox["\[Pi]", "2"]}], ",", 
      RowBox[{"0", "<", "c", "<", 
       RowBox[{"2", " ", "\[Pi]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], "<", "\[Phi]", "<", 
       FractionBox["\[Pi]", "2"]}], ",", 
      RowBox[{"0", "<", "\[Lambda]", "<", 
       RowBox[{"2", " ", "\[Pi]"}]}]}], "}"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.859859208778756*^9, 3.8598592920941973`*^9, 
  3.859859441062744*^9, 3.859859536878971*^9, 3.859859795815649*^9, 
  3.859859944531707*^9, 3.859859988893272*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"df716d57-c2c4-434f-9e52-51f2011e2fed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["rp"], "Input",
 CellChangeTimes->{{3.859519128739225*^9, 3.859519128914785*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"16de3871-5844-4098-8040-1326173f4ad6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", 
    RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], ",", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.859519129532338*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"a76cc43b-ad4d-474b-8e61-8bb6e24f5b96"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "this", " ", "is", " ", "the", " ", "x", " ", "coordinate", " ", "in", " ", 
   "the", " ", "3", "D", " ", "projection"}], "*)"}]], "Input",
 CellChangeTimes->{{3.85943167129843*^9, 
  3.859431678167716*^9}},ExpressionUUID->"38184145-a4de-4bc8-90f5-\
7638c0e02e8c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"rp", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], 
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", "d"}]]}], ")"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8594315980376377`*^9, 3.8594316075738163`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"1ce1dd9f-ce4a-49a0-baf9-0e45ca4cdbad"],

Cell["\<\
(d*(Cos(c)*Cos(a - \[Lambda])*Cos(\[Phi]) - Sin(c)*(Cos(b)*Cos(\[Phi])*Sin(a \
- \[Lambda]) + Sin(b)*Sin(\[Phi]))))/
   (d + l + Cos(a - \[Lambda])*Cos(\[Phi])*Sin(c) + \
Cos(b)*Cos(c)*Cos(\[Phi])*Sin(a - \[Lambda]) + Cos(c)*Sin(b)*Sin(\[Phi]))\
\>", "Output",
 CellChangeTimes->{{3.8591275458450193`*^9, 3.859127556887639*^9}, 
   3.8591279298122473`*^9, 3.859431610598949*^9},
 CellLabel->
  "Out[46]//CForm=",ExpressionUUID->"88e3c74e-9409-42cc-b98c-14927e8a2a59"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "this", " ", "is", " ", "the", " ", "z", " ", "coordinate", " ", "in", " ", 
   "the", " ", "3", "d", " ", "projection"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8594316800256166`*^9, 
  3.859431685311953*^9}},ExpressionUUID->"f2c7bf94-e25a-45d9-ae90-\
edfc4966ae6a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"rp", "[", 
     RowBox[{"[", "3", "]"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], 
       RowBox[{"l", "+", 
        RowBox[{"rp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", "d"}]]}], ")"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8594316170976257`*^9, 3.859431623030797*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"e39e7286-994f-4f1a-ac50-905416e67e55"],

Cell["\<\
(-(d*Cos(\[Phi])*Sin(b)*Sin(a - \[Lambda])) + d*Cos(b)*Sin(\[Phi]))/(d + l + \
Cos(a - \[Lambda])*Cos(\[Phi])*Sin(c) + Cos(b)*Cos(c)*Cos(\[Phi])*Sin(a - \
\[Lambda]) + Cos(c)*Sin(b)*Sin(\[Phi]))\
\>", "Output",
 CellChangeTimes->{3.8594316252298813`*^9},
 CellLabel->
  "Out[47]//CForm=",ExpressionUUID->"78d173b4-46c5-482f-abb0-a2772575d232"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"rp", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.859432113360612*^9, 3.8594321247090282`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"bdfc72f8-9c5c-46ab-8074-e144934b635d"],

Cell["\<\
Cos(a - \[Lambda])*Cos(\[Phi])*Sin(c) + Cos(c)*(Cos(b)*Cos(\[Phi])*Sin(a - \
\[Lambda]) + Sin(b)*Sin(\[Phi]))\
\>", "Output",
 CellChangeTimes->{{3.859432116471767*^9, 3.859432125580924*^9}},
 CellLabel->
  "Out[49]//CForm=",ExpressionUUID->"72b1f983-2cc8-4680-ae31-badcd436938f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "==", 
      RowBox[{"xp", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"l", "+", "yp"}], 
          RowBox[{"l", "+", "yp", "+", "d"}]]}], ")"}]}]}], ",", 
     RowBox[{"z", "==", 
      RowBox[{"zp", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"l", "+", "yp"}], 
          RowBox[{"l", "+", "yp", "+", "d"}]]}], ")"}]}]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{"yp", "->", 
     RowBox[{"\[Sigma]", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"xp", "^", "2"}], "-", 
        RowBox[{"zp", "^", "2"}]}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.859955541392531*^9, 3.8599556264780607`*^9}, {
  3.85995776342951*^9, 3.8599577777567263`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"19b9620a-7921-482a-8fa9-eaa283ff2567"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "\[Equal]", 
    RowBox[{"xp", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"l", "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["xp", "2"], "-", 
            SuperscriptBox["zp", "2"]}]], " ", "\[Sigma]"}]}], 
        RowBox[{"d", "+", "l", "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["xp", "2"], "-", 
            SuperscriptBox["zp", "2"]}]], " ", "\[Sigma]"}]}]]}], ")"}]}]}], 
   ",", 
   RowBox[{"z", "\[Equal]", 
    RowBox[{"zp", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"l", "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["xp", "2"], "-", 
            SuperscriptBox["zp", "2"]}]], " ", "\[Sigma]"}]}], 
        RowBox[{"d", "+", "l", "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["xp", "2"], "-", 
            SuperscriptBox["zp", "2"]}]], " ", "\[Sigma]"}]}]]}], ")"}]}]}]}],
   "}"}]], "Output",
 CellChangeTimes->{{3.859955622617691*^9, 3.859955626943922*^9}, {
   3.859957764156843*^9, 3.859957778811392*^9}, 3.859961654448841*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"911dd897-e08b-41cc-8c4f-53283f1989be"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "These", " ", "must", " ", "be", " ", "the", " ", "two", " ", "soluions", 
    " ", "corresponding", " ", "to", " ", 
    RowBox[{"y", "'"}]}], " ", "<", " ", 
   RowBox[{"0", " ", "and", " ", 
    RowBox[{"y", "'"}]}], " ", ">", " ", "0"}], "*)"}]], "Input",
 CellChangeTimes->{{3.859957827963541*^9, 
  3.8599578451466503`*^9}},ExpressionUUID->"d06c343f-ee8f-40a0-bb80-\
65e872c25441"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"eq", ",", 
     RowBox[{"{", 
      RowBox[{"xp", ",", "zp"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.859955630038157*^9, 3.859955651508903*^9}, {
  3.859957508723961*^9, 3.859957509274167*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"cb274434-3bf5-46f5-a12b-2da0c3bf49fc"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "nongen", 
   "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 12, 1, 20355337511459708054, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.859955644613162*^9, 3.859955651867888*^9}, 
   3.859957509905678*^9, {3.8599577666286592`*^9, 3.859957780295978*^9}, 
   3.859961118234748*^9, 3.8599616581424847`*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"43f745a6-41cd-40b9-a890-268be01010fe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xp", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], " ", 
          SuperscriptBox["\[Sigma]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "l", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"l", "-", "\[Sigma]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"l", "+", "\[Sigma]"}], ")"}]}]}], ")"}]}]]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], " ", 
         SuperscriptBox["\[Sigma]", "2"]}]}]]}], ",", 
     RowBox[{"zp", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
        RowBox[{"z", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["x", "2"]}], " ", 
           SuperscriptBox["\[Sigma]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{"2", " ", "d", " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"l", "-", "\[Sigma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"l", "+", "\[Sigma]"}], ")"}]}]}], ")"}]}]]}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xp", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], " ", 
          SuperscriptBox["\[Sigma]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "l", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"l", "-", "\[Sigma]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"l", "+", "\[Sigma]"}], ")"}]}]}], ")"}]}]]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], " ", 
         SuperscriptBox["\[Sigma]", "2"]}]}]]}], ",", 
     RowBox[{"zp", "\[Rule]", 
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            SuperscriptBox["\[Sigma]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"l", "-", "\[Sigma]"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"l", "+", "\[Sigma]"}], ")"}]}]}], ")"}]}]]}], 
         ")"}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.859955636107126*^9, 3.8599556525487213`*^9}, 
   3.859957509914427*^9, {3.859957767292571*^9, 3.859957781218351*^9}, 
   3.8599611182440777`*^9, 3.859961659154664*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"b3b6a915-4c06-4568-81b4-ab91399cfae8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"sol", "/.", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", "->", "1"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.859961093454752*^9, 3.859961108668091*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"d988cdef-9059-4339-8a10-d379612401b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xp", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "l", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "l"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}], ",", 
     RowBox[{"zp", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
        RowBox[{"z", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["x", "2"]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{"2", " ", "d", " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xp", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "l", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "l"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}], ",", 
     RowBox[{"zp", "\[Rule]", 
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "l"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.859961101182055*^9, 3.859961120035697*^9}, 
   3.859961661037127*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"056f1a56-537e-4b4f-9343-ff383ee6bda8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rp", "=", 
  RowBox[{"{", 
   RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.859961497348755*^9, 3.859961502139164*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"26a749cd-3f4e-472b-8165-efbef2915cee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]], "Output",
 CellChangeTimes->{3.859961510174076*^9, 3.8599616671315317`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"9202f6b4-cd79-46fc-b9d3-6a654687d512"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"iR", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", "rp"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"yp", "->", 
        RowBox[{"-", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"xp", "^", "2"}], "-", 
           RowBox[{"zp", "^", "2"}]}], "]"}]}]}], "}"}]}], "/.", "sol"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8599613967443027`*^9, 3.8599614417274723`*^9}, {
  3.859961605926984*^9, 3.859961632407567*^9}, {3.8599616912712507`*^9, 
  3.8599617175661697`*^9}, {3.8599619619452047`*^9, 3.859961979680546*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"940b91cc-1da8-4f88-9608-d2883b7eceff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
           RowBox[{"z", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{"2", " ", "d", " ", "l", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["l", "2"]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], ")"}],
          " ", 
         RowBox[{"Sin", "[", "a", "]"}], " ", 
         RowBox[{"Sin", "[", "b", "]"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["x", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{"2", " ", "d", " ", "l", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
           "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
             RowBox[{"z", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["x", "2"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "d", " ", "l", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], 
            ")"}], "2"], 
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "2"], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "b", "]"}]}], " ", 
          RowBox[{"Cos", "[", "c", "]"}], " ", 
          RowBox[{"Sin", "[", "a", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "a", "]"}], " ", 
          RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "a", "]"}], " ", 
           RowBox[{"Cos", "[", "c", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "b", "]"}], " ", 
           RowBox[{"Sin", "[", "a", "]"}], " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
           RowBox[{"z", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{"2", " ", "d", " ", "l", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["l", "2"]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], ")"}],
          " ", 
         RowBox[{"Cos", "[", "a", "]"}], " ", 
         RowBox[{"Sin", "[", "b", "]"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "c", "]"}]}], " ", 
           RowBox[{"Sin", "[", "a", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "a", "]"}], " ", 
           RowBox[{"Cos", "[", "b", "]"}], " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["x", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{"2", " ", "d", " ", "l", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
           "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
             RowBox[{"z", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["x", "2"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "d", " ", "l", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], 
            ")"}], "2"], 
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "2"], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "a", "]"}], " ", 
          RowBox[{"Cos", "[", "b", "]"}], " ", 
          RowBox[{"Cos", "[", "c", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "a", "]"}], " ", 
          RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
          RowBox[{"z", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["x", "2"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["d", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}], "+", 
               RowBox[{"2", " ", "d", " ", "l", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["l", "2"]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], ")"}], 
        " ", 
        RowBox[{"Cos", "[", "b", "]"}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["x", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{"2", " ", "d", " ", "l", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
           "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
             RowBox[{"z", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["x", "2"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "d", " ", "l", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], 
            ")"}], "2"], 
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "2"], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]], " ", 
       RowBox[{"Cos", "[", "c", "]"}], " ", 
       RowBox[{"Sin", "[", "b", "]"}]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"Sin", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["x", "2"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["d", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}], "+", 
               RowBox[{"2", " ", "d", " ", "l", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["l", "2"]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
         " ", 
         RowBox[{"Sin", "[", "a", "]"}], " ", 
         RowBox[{"Sin", "[", "b", "]"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["x", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{"2", " ", "d", " ", "l", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
           "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["x", "2"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "d", " ", "l", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
            "2"]}], 
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "2"], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "b", "]"}]}], " ", 
          RowBox[{"Cos", "[", "c", "]"}], " ", 
          RowBox[{"Sin", "[", "a", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "a", "]"}], " ", 
          RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "a", "]"}], " ", 
           RowBox[{"Cos", "[", "c", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "b", "]"}], " ", 
           RowBox[{"Sin", "[", "a", "]"}], " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["x", "2"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["d", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}], "+", 
               RowBox[{"2", " ", "d", " ", "l", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["l", "2"]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
         " ", 
         RowBox[{"Cos", "[", "a", "]"}], " ", 
         RowBox[{"Sin", "[", "b", "]"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "c", "]"}]}], " ", 
           RowBox[{"Sin", "[", "a", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "a", "]"}], " ", 
           RowBox[{"Cos", "[", "b", "]"}], " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["x", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{"2", " ", "d", " ", "l", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
           "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["x", "2"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "d", " ", "l", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
            "2"]}], 
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "2"], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "a", "]"}], " ", 
          RowBox[{"Cos", "[", "b", "]"}], " ", 
          RowBox[{"Cos", "[", "c", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "a", "]"}], " ", 
          RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"Cos", "[", "b", "]"}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["x", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{"2", " ", "d", " ", "l", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
           "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["x", "2"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "d", " ", "l", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
            "2"]}], 
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "2"], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]], " ", 
       RowBox[{"Cos", "[", "c", "]"}], " ", 
       RowBox[{"Sin", "[", "b", "]"}]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"Sin", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.859961430118897*^9, 3.8599614644032*^9, 3.859961577745062*^9, {
   3.859961686802576*^9, 3.8599616993115273`*^9}, {3.859961959790288*^9, 
   3.859961980720538*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"84a1efc7-9d91-479c-9339-eb79c1a2164d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/", 
    RowBox[{"sol", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8599619849933987`*^9, 3.859961986720364*^9}, {
  3.859962040925506*^9, 3.8599620449173717`*^9}, {3.859962084525772*^9, 
  3.8599621088764687`*^9}, {3.8599621767447157`*^9, 3.8599621989607077`*^9}, {
  3.8599626165464973`*^9, 3.8599626170968657`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"c4173914-cf80-4b4b-8da8-edffb0fd01f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
       RowBox[{"z", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "l", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["l", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], ")"}], 
     " ", 
     RowBox[{"Cos", "[", "a", "]"}], " ", 
     RowBox[{"Sin", "[", "b", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["x", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", "d", " ", "l", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["l", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "c", "]"}], " ", 
        RowBox[{"Sin", "[", "a", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], " ", 
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["d", "2"], "+", 
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           FractionBox[
            SuperscriptBox["z", "2"], 
            SuperscriptBox["x", "2"]]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d"}], " ", 
             RowBox[{"(", 
              RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{"2", " ", "d", " ", "l", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["l", "2"]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
          "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2"]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], " ", 
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Cos", "[", "c", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "a", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"x", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["z", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
           RowBox[{"z", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{"2", " ", "d", " ", "l", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["l", "2"]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], ")"}],
          " ", 
         RowBox[{"Sin", "[", "a", "]"}], " ", 
         RowBox[{"Sin", "[", "b", "]"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             FractionBox[
              SuperscriptBox["z", "2"], 
              SuperscriptBox["x", "2"]]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["x", "2"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "d", " ", "l", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["l", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
            "2"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["d", "2"], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "b", "]"}]}], " ", 
          RowBox[{"Cos", "[", "c", "]"}], " ", 
          RowBox[{"Sin", "[", "a", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "a", "]"}], " ", 
          RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "a", "]"}], " ", 
           RowBox[{"Cos", "[", "c", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "b", "]"}], " ", 
           RowBox[{"Sin", "[", "a", "]"}], " ", 
           RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}], ")"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.859962592673669*^9, 3.85996259939498*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"d2df595d-5a06-40b5-aced-e566905e1003"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"sol", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.859962202767316*^9, 3.8599622080632753`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"57942e06-0bda-494b-be9b-a77cbf1cd2a8"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
      RowBox[{"z", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["x", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", "d", " ", "l", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["l", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], ")"}], " ", 
    RowBox[{"Cos", "[", "b", "]"}]}], 
   RowBox[{"x", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["z", "2"]}], ")"}]}]], "-", 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["x", "2"]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{"2", " ", "d", " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["l", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
       "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["d", "2"], "+", 
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], "2"]], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "l"}], ")"}], " ", "x", " ", "z"}], "-", 
         RowBox[{"z", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}]}], ")"}], 
       "2"], 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]], " ", 
   RowBox[{"Cos", "[", "c", "]"}], " ", 
   RowBox[{"Sin", "[", "b", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "-", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["x", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}], "+", 
          RowBox[{"2", " ", "d", " ", "l", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["l", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], " ", 
    RowBox[{"Sin", "[", "b", "]"}], " ", 
    RowBox[{"Sin", "[", "c", "]"}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], "+", 
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["z", "2"]}]]}]], "Output",
 CellChangeTimes->{3.85996220885992*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"ba87a88e-cbb0-4e87-99c1-18d18702ce65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], "2"], "-", 
     RowBox[{
      RowBox[{"(", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "d", " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["l", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
        "2"], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"z", "^", "2"}], "/", 
         RowBox[{"x", "^", "2"}]}]}], ")"}]}]}], ")"}], "/", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["z", "2"]}], ")"}], "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.8599624019922028`*^9, 3.8599625098217793`*^9}, {
  3.859962544188415*^9, 3.859962549451785*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"5406c138-ac6e-4e9b-9d2d-1d9d28147009"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       SuperscriptBox["z", "2"], 
       SuperscriptBox["x", "2"]]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d"}], " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", "l"}], ")"}], " ", "x"}], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["x", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", "d", " ", "l", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["l", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]]}], ")"}], 
     "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["z", "2"]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{
  3.859962441038437*^9, {3.85996248189501*^9, 3.8599625108832693`*^9}, {
   3.859962545659175*^9, 3.859962551828685*^9}},
 CellLabel->"Out[38]=",ExpressionUUID->"cbf7d9b6-0c8d-4320-97b5-d5ab5bc62bef"]
}, Open  ]]
},
WindowSize->{1920, 942},
WindowMargins->{{0, Automatic}, {Automatic, -180}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d2405eff-1772-4f1d-92d4-d368e1398865"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1901, 53, 73, "Input",ExpressionUUID->"60ae39d5-f08a-4530-902f-b6bff550122b"],
Cell[CellGroupData[{
Cell[2484, 77, 595, 17, 30, "Input",ExpressionUUID->"8dfd3938-563d-450c-97dd-33ed5a2f6d68"],
Cell[3082, 96, 616, 17, 34, "Output",ExpressionUUID->"f1fa26b1-fb94-4a39-a006-a7fb0ffea0a7"]
}, Open  ]],
Cell[3713, 116, 1448, 37, 30, "Input",ExpressionUUID->"9049e561-296f-46c3-907a-97807f017e83"],
Cell[5164, 155, 431, 11, 30, "Input",ExpressionUUID->"e4b20a12-0b2f-42fe-b300-3174ad592b12"],
Cell[5598, 168, 405, 10, 30, "Input",ExpressionUUID->"427f537c-be83-493b-92ca-4ebd55cfd7c0"],
Cell[6006, 180, 614, 16, 30, "Input",ExpressionUUID->"740ac50e-a62d-4698-854f-37246afe1d1d"],
Cell[CellGroupData[{
Cell[6645, 200, 385, 9, 30, "Input",ExpressionUUID->"9243d912-5fdc-430b-bfb5-e22ab335b895"],
Cell[7033, 211, 2456, 65, 56, "Output",ExpressionUUID->"e5f15f91-4179-4f0e-a9a3-6982ae7af42f"]
}, Open  ]],
Cell[9504, 279, 317, 7, 52, "Input",ExpressionUUID->"1580e638-9c7a-4330-a60d-265146e70ada"],
Cell[CellGroupData[{
Cell[9846, 290, 540, 14, 51, "Input",ExpressionUUID->"dab47f82-da66-47e6-b516-59954412286c"],
Cell[10389, 306, 763, 19, 53, "Output",ExpressionUUID->"a5b191c3-7e25-4a5c-8828-56e77d0fc23d"]
}, Open  ]],
Cell[11167, 328, 1969, 51, 30, "Input",ExpressionUUID->"66ac335d-df3f-4e35-bf61-01a1eab1640a"],
Cell[CellGroupData[{
Cell[13161, 383, 359, 7, 30, "Input",ExpressionUUID->"bfc3cea5-339f-47a4-9e8f-e731e8d7df0c"],
Cell[13523, 392, 2483, 73, 56, "Output",ExpressionUUID->"a2b52007-c555-4738-b681-95ecf4ea29cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16043, 470, 531, 10, 30, "Input",ExpressionUUID->"fe4e88a1-ff55-4211-abc2-dc773b1d80df"],
Cell[16577, 482, 359, 9, 28, "Message",ExpressionUUID->"c73d39d2-b914-46ed-b43c-30ba841f281d"],
Cell[16939, 493, 3494, 97, 75, "Output",ExpressionUUID->"df716d57-c2c4-434f-9e52-51f2011e2fed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20470, 595, 173, 2, 30, "Input",ExpressionUUID->"16de3871-5844-4098-8040-1326173f4ad6"],
Cell[20646, 599, 463, 12, 34, "Output",ExpressionUUID->"a76cc43b-ad4d-474b-8e61-8bb6e24f5b96"]
}, Open  ]],
Cell[21124, 614, 308, 7, 30, "Input",ExpressionUUID->"38184145-a4de-4bc8-90f5-7638c0e02e8c"],
Cell[CellGroupData[{
Cell[21457, 625, 597, 17, 51, "Input",ExpressionUUID->"1ce1dd9f-ce4a-49a0-baf9-0e45ca4cdbad"],
Cell[22057, 644, 477, 9, 63, "Output",ExpressionUUID->"88e3c74e-9409-42cc-b98c-14927e8a2a59"]
}, Open  ]],
Cell[22549, 656, 311, 7, 30, "Input",ExpressionUUID->"f2c7bf94-e25a-45d9-ae90-edfc4966ae6a"],
Cell[CellGroupData[{
Cell[22885, 667, 595, 17, 51, "Input",ExpressionUUID->"e39e7286-994f-4f1a-ac50-905416e67e55"],
Cell[23483, 686, 353, 7, 45, "Output",ExpressionUUID->"78d173b4-46c5-482f-abb0-a2772575d232"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23873, 698, 299, 6, 30, "Input",ExpressionUUID->"bdfc72f8-9c5c-46ab-8074-e144934b635d"],
Cell[24175, 706, 290, 6, 45, "Output",ExpressionUUID->"72b1f983-2cc8-4680-ae31-badcd436938f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24502, 717, 955, 28, 51, "Input",ExpressionUUID->"19b9620a-7921-482a-8fa9-eaa283ff2567"],
Cell[25460, 747, 1381, 41, 63, "Output",ExpressionUUID->"911dd897-e08b-41cc-8c4f-53283f1989be"]
}, Open  ]],
Cell[26856, 791, 443, 11, 30, "Input",ExpressionUUID->"d06c343f-ee8f-40a0-bb80-65e872c25441"],
Cell[CellGroupData[{
Cell[27324, 806, 398, 9, 30, "Input",ExpressionUUID->"cb274434-3bf5-46f5-a12b-2da0c3bf49fc"],
Cell[27725, 817, 525, 11, 28, "Message",ExpressionUUID->"43f745a6-41cd-40b9-a890-268be01010fe"],
Cell[28253, 830, 6599, 187, 123, "Output",ExpressionUUID->"b3b6a915-4c06-4568-81b4-ab91399cfae8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34889, 1022, 289, 6, 30, "Input",ExpressionUUID->"d988cdef-9059-4339-8a10-d379612401b1"],
Cell[35181, 1030, 5848, 168, 123, "Output",ExpressionUUID->"056f1a56-537e-4b4f-9343-ff383ee6bda8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41066, 1203, 255, 5, 30, "Input",ExpressionUUID->"26a749cd-3f4e-472b-8165-efbef2915cee"],
Cell[41324, 1210, 231, 4, 34, "Output",ExpressionUUID->"9202f6b4-cd79-46fc-b9d3-6a654687d512"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41592, 1219, 877, 21, 30, "Input",ExpressionUUID->"940b91cc-1da8-4f88-9608-d2883b7eceff"],
Cell[42472, 1242, 41111, 1132, 812, "Output",ExpressionUUID->"84a1efc7-9d91-479c-9339-eb79c1a2164d"]
}, Open  ]],
Cell[83598, 2377, 707, 16, 30, "Input",ExpressionUUID->"c4173914-cf80-4b4b-8da8-edffb0fd01f1"],
Cell[84308, 2395, 10912, 312, 351, InheritFromParent,ExpressionUUID->"d2df595d-5a06-40b5-aced-e566905e1003"],
Cell[CellGroupData[{
Cell[95245, 2711, 363, 8, 30, "Input",ExpressionUUID->"57942e06-0bda-494b-be9b-a77cbf1cd2a8"],
Cell[95611, 2721, 5835, 176, 189, "Output",ExpressionUUID->"ba87a88e-cbb0-4e87-99c1-18d18702ce65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101483, 2902, 2104, 61, 40, "Input",ExpressionUUID->"5406c138-ac6e-4e9b-9d2d-1d9d28147009"],
Cell[103590, 2965, 1740, 53, 70, "Output",ExpressionUUID->"cbf7d9b6-0c8d-4320-97b5-d5ab5bc62bef"]
}, Open  ]]
}
]
*)

